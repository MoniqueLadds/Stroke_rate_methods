{
    "collab_server" : "",
    "contents" : "rm(list=ls())\n\n#########density plot\nload(\"data/harness/Xpredictions.RData\")\nsource(\"r/harness/Functions.R\")\n\n##find the differences\nnames(df)\nstroke<-data.frame(df[c(1:19)], \n                   apply(df[20:44],2,diffs))\nstroke<-stroke[complete.cases(stroke),]\n\nsummary.x<-apply(X = stroke[20:44],2,summary)\nrange.x<-apply(stroke[20:44],2,function(x) max(x)-min(x))\nmedian.x<-apply(stroke[20:44],2,median)\nmean.x<-apply(X = stroke[20:44],2,mean)\nsd.x<-apply(X = stroke[20:44],2,sd)\nztest.x<-apply(X = stroke[20:44],2,function(x) z.test(a=x,mu=0,var=15))\napply(X = stroke[20:44],2,function(x) t.test(a=x,mu=0))\n\nt.test(stroke$peak_32_60,mu=0)\n\nexport.x<-cbind(mean.x,sd.x,median.x,range.x,ztest.x)\nwrite.csv(export.x,\"output/harness/summarystatsX.csv\")\n\n\n###individual errors\nindiv<-unique(stroke$Animal)\n\n#extract out individual\n  dat<-stroke[stroke$Animal==indiv[4],]\n  \n  ##Find the mean difference\n  indiv.mean<-apply(dat[20:44],2,mean)\n  #find the corresponding RM and gradient\n  best.name<-names(indiv.mean[abs(indiv.mean)==min(abs(indiv.mean))])\n  best.mean<-min(abs(indiv.mean))\n  \n  #extract the best data\n    best.diff<-dat[,names(dat)==best.name]\n    #and the corresponding strokes\n    strokes<-dat$strokes\n    #calculate the % diff\n    percent.diff<-data.frame(cbind(best.diff,strokes))\n    percent.diff$diff<-(percent.diff$best.diff+abs(percent.diff$strokes))/percent.diff$best.diff\n    avg.diff<-mean(percent.diff$diff)\n  \n    \n    \n    #make the histogram\n    tiff(\"figs/harness/xhist.tiff\",width = 600, height = 400)\n    \n    #extract the data\n    plotData <- stroke$peak_13_60 \n    h<-hist(plotData, breaks=10,border=\"white\", \n            xlab=\"\", ylab = \"\", main=\"\", cex.axis = 1.5,\n            ylim=c(0,10),xlim=c(-30,30)) \n    mtext(\"Frequency\",2,2.2,cex = 1.5)\n    mtext(\"Predicitions\",1,2, cex = 1.5)\n    text(30,10,\"D\",cex=1.5)\n    \n    \n    ###function for the additional lines\n    density_lines<-function(lineData,col){\n      xfit<-seq(min(lineData),max(lineData),length=40) \n      yfit<-dnorm(xfit,mean=mean(lineData),sd=sd(lineData)) \n      yfit <- yfit*diff(h$mids[1:2])*length(lineData) \n      lines(xfit, yfit, col=col, lwd=2)\n    }\n    \n    #plot the lines\n    \n    lineData <- stroke$peak_13_60\n    density_lines(lineData, \"mediumorchid1\")\n    \n    lineData <- stroke$peak_13_70\n    density_lines(lineData, \"hotpink3\")\n    \n    lineData <- stroke$peak_13_80\n    density_lines(lineData, \"darkorchid1\")\n    \n    lineData <- stroke$peak_13_90\n    density_lines(lineData, \"darkorchid1\")\n    \n    lineData <- stroke$peak_13_100\n    density_lines(lineData, \"darkmagenta\")\n    \n    lineData <- stroke$peak_32_60\n    density_lines(lineData, \"darkolivegreen\")\n    \n    #lineData <- stroke$peak_32_70\n    #density_lines(lineData, \"chartreuse\")\n    \n    lineData <- stroke$peak_32_80\n    density_lines(lineData, \"chartreuse3\")\n    \n    lineData <- stroke$peak_32_90\n    density_lines(lineData, \"chartreuse4\")\n    \n    #lineData <- stroke$peak_32_100\n    #density_lines(lineData, \"darkgreen\")\n    \n    lineData <- stroke$peak_64_60\n    density_lines(lineData, \"cadetblue1\")\n    \n    #lineData <- stroke$peak_64_70\n    #density_lines(lineData, \"deepskyblue\")\n    \n    lineData <- stroke$peak_64_80\n    density_lines(lineData, \"blue\")\n    \n    lineData <- stroke$peak_64_90\n    density_lines(lineData, \"blue4\")\n    \n    #lineData <- stroke$peak_64_100\n    #density_lines(lineData, \"cadetblue4\")\n    \n    lineData <- stroke$peak_96_60\n    density_lines(lineData, \"tan\")\n    \n    #lineData <- stroke$peak_96_70\n    #density_lines(lineData, \"orange\")\n    \n    lineData <- stroke$peak_96_80\n    density_lines(lineData, \"orange\")\n    \n    lineData <- stroke$peak_96_90\n    density_lines(lineData, \"orange4\")\n    \n    #lineData <- stroke$peak_96_100\n    #density_lines(lineData, \"darkorange4\")\n    \n    lineData <- stroke$peak_128_60\n    density_lines(lineData, \"indianred\")\n    \n    #lineData <- stroke$peak_128_70\n    #density_lines(lineData, \"firebrick1\")\n    \n    lineData <- stroke$peak_128_80\n    density_lines(lineData, \"red\")\n    \n    lineData <- stroke$peak_128_90\n    density_lines(lineData, \"red4\")\n    \n    #lineData <- stroke$peak_128_100\n    #density_lines(lineData, \"violetred4\")\n    \n    \n    ###add the legend\n    legend(-32,10.5,lty=c(1,1),cex=0.8,bty=\"n\",bg=\"n\",\n           c(\"RM:0.4; G:60\",\n             #\"RM:0.4; G:70\",\n             \"RM:0.4; G:80\",\n             \"RM:0.4; G:90\",\n             #\"RM:0.4; G:100\",\n             \"RM:1; G:60\",\n             #\"RM:1; G:70\",\n             \"RM:1; G:80\",\n             \"RM:1; G:90\",\n             #\"RM:1; G:100\",\n             \"RM:2; G:60\",\n             #\"RM:2; G:70\",\n             \"RM:2; G:80\",\n             \"RM:2; G:90\",\n             #\"RM:2; G:100\",\n             \"RM:3; G:60\",\n             #\"RM:3; G:70\",\n             \"RM:3; G:80\",\n             \"RM:3; G:90\",\n             #\"RM:3; G:100\",\n             \"RM:4; G:60\",\n             #\"RM:4; G:70\",\n             \"RM:4; G:80\",\n             \"RM:4; G:90\"\n             #\"RM:4; G:100\"\n           ),\n           col=c(\"mediumorchid1\",\n                 #\"hotpink3\",\n                 \"darkorchid1\",\n                 \"darkorchid2\",\n                 #\"darkmagenta\",\n                 \"darkolivegreen1\",\n                 #\"chartreuse\",\n                 \"chartreuse3\",\n                 \"chartreuse4\",\n                 #\"darkgreen\",\n                 \"cadetblue1\",\n                 #\"deepskyblue\",\n                 \"blue\",\n                 \"blue4\",\n                 #\"cadetblue4\",\n                 \"tan\",\n                 #\"orange\",\n                 \"orange\",\n                 \"orange4\",\n                 #\"darkorange4\",\n                 \"indianred\",\n                 #\"firebrick1\",\n                 \"red\",\n                 \"red4\"\n                 #\"violetred4\"\n           ))\n    \n    dev.off()\n    ",
    "created" : 1481842298512.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "201353390",
    "id" : "1EDE6706",
    "lastKnownWriteTime" : 1481842325,
    "last_content_update" : 1481842325742,
    "path" : "~/Stroke rate methods/R/harness/x_summary.R",
    "project_path" : "R/harness/x_summary.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}