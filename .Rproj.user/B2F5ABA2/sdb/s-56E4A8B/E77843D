{
    "collab_server" : "",
    "contents" : "#####Make the plots\nrm(list=ls())\n\n#########density plot\nload(\"data/tape/Xpredictions.RData\")\nsource(\"r/tape/Functions.R\")\n\n##add animal info and actual number of strokes to the data frame\ndat<-read.csv(\"data/tape/odba_vo2_data.csv\")\npredictions<-merge(predictions,dat[,c(2,18:23)],all.x = TRUE, by = \"id2\")\npredictions<-predictions[!predictions$id2==\"Rocky31-10-14_1.csv\",]\n#predictions<-predictions[complete.cases(predictions$stroke_rate),]\npredictions$name<-droplevels(predictions$name)\n\n\n##find the differences\nnames(predictions)\nstroke<-data.frame(predictions[c(1,27:32)], \n                   apply(predictions[2:26],2,diffs))\nstroke<-stroke[complete.cases(stroke),]\n\n\n    ###Summarise the differences\n    summary.x<-apply(X = stroke[7:32],2,summary)\n    range.x<-apply(stroke[7:32],2,function(x) max(x)-min(x))\n    median.x<-apply(stroke[7:32],2,median)\n    mean.x<-apply(X = stroke[7:32],2,mean)\n    sd.x<-apply(X = stroke[7:32],2,sd)\n    ttest.x<-apply(X = stroke[7:32],2,t.test)\n\n    t.test(stroke$peak_0.4sec_40_dyn.x,mu=0)$p.value\n    \nexport.x<-cbind(mean.x,sd.x,median.x,range.x,ztest.x)\nwrite.csv(export.x,\"data/tape/summarystatsX.csv\")\n\n\n###individual errors\nindiv<-unique(as.character(stroke$name))\n\noutput<-NULL\npredict<-NULL\nfor(l in 1:length(indiv)){\n  \n  #extract out individual\n  dat<-stroke[stroke$name==indiv[l],]\n\n    ##Find the mean difference\n    indiv.mean<-apply(dat[8:32],2,mean)\n    \n    #find the corresponding RM and gradient\n    best.name<-names(indiv.mean[abs(indiv.mean)==min(abs(indiv.mean))])\n    best.mean<-min(abs(indiv.mean))\n\n      #extract the best data\n      best.diff<-dat[,names(dat)==best.name]\n      \n      #and the corresponding strokes\n      strokes<-dat$stroke_rate\n      \n      #calculate the % diff\n      percent.diff<-data.frame(cbind(best.diff,strokes))\n      percent.diff$diff<-(percent.diff$best.diff+abs(percent.diff$strokes))/percent.diff$best.diff\n      percent.diff$diff[which(percent.diff$diff==Inf)]<-0\n      avg.diff<-mean(percent.diff$diff)\n\n      output <- cbind(indiv[l],best.name,best.mean,avg.diff)\n      \n      predict<-data.frame(rbind(predict,output))\n      }\n\n\n\n\ntiff(\"figs/tape/tape_xhist.tiff\",width = 600, height = 400)\n\n#make the histogram\n#extract the data\nplotData <- stroke$peak_0.4sec_30_dyn.x \npar(mar=c(3.5,3.5,1,1))\nh<-hist(plotData, breaks=10,border=\"white\", \n        xlab=\"\",ylab = \"\",main=\"\",cex.axis = 1.5,\n        ylim=c(0,30),xlim=c(-30,50)) \ntext(50,30,\"A\",cex=1.5)\nmtext(\"Predicitons\",1,2,cex = 1.5)\nmtext(\"Frequency\",2,2.2,cex = 1.5)\n###function for the additional lines\ndensity_lines<-function(lineData,col){\n  xfit<-seq(min(lineData),max(lineData),length=40) \n  yfit<-dnorm(xfit,mean=mean(lineData),sd=sd(lineData)) \n  yfit <- yfit*diff(h$mids[1:2])*length(lineData) \n  lines(xfit, yfit, col=col, lwd=2)\n}\n\n#lineData <- stroke$peak_0.4sec_10_dyn.x\n#density_lines(lineData, \"mediumorchid1\")\n\nlineData <- stroke$peak_0.4sec_20_dyn.x\ndensity_lines(lineData, \"hotpink3\")\n\nlineData <- stroke$peak_0.4sec_30_dyn.x\ndensity_lines(lineData, \"darkorchid1\")\n\n#lineData <- stroke$peak_0.4sec_40_dyn.x\n#density_lines(lineData, \"darkorchid1\")\n\nlineData <- stroke$peak_0.4sec_50_dyn.x\ndensity_lines(lineData, \"darkmagenta\")\n\n#lineData <- stroke$peak_1sec_10_dyn.x\n#density_lines(lineData, \"darkolivegreen\")\n\nlineData <- stroke$peak_1sec_20_dyn.x\ndensity_lines(lineData, \"chartreuse\")\n\nlineData <- stroke$peak_1sec_30_dyn.x\ndensity_lines(lineData, \"chartreuse3\")\n\n#lineData <- stroke$peak_1sec_40_dyn.x\n#density_lines(lineData, \"chartreuse4\")\n\nlineData <- stroke$peak_1sec_50_dyn.x\ndensity_lines(lineData, \"darkgreen\")\n\n#lineData <- stroke$peak_2sec_10_dyn.x\n#density_lines(lineData, \"cadetblue1\")\n\nlineData <- stroke$peak_2sec_20_dyn.x\ndensity_lines(lineData, \"deepskyblue\")\n\nlineData <- stroke$peak_2sec_30_dyn.x\ndensity_lines(lineData, \"blue\")\n\n#lineData <- stroke$peak_2sec_40_dyn.x\n#density_lines(lineData, \"cadetblue4\")\n\nlineData <- stroke$peak_2sec_50_dyn.x\ndensity_lines(lineData, \"blue4\")\n\n#lineData <- stroke$peak_3sec_10_dyn.x\n#density_lines(lineData, \"tan\")\n\nlineData <- stroke$peak_3sec_20_dyn.x\ndensity_lines(lineData, \"orange\")\n\nlineData <- stroke$peak_3sec_30_dyn.x\ndensity_lines(lineData, \"darkorange\")\n\n#lineData <- stroke$peak_3sec_40_dyn.x\n#density_lines(lineData, \"coral\")\n\nlineData <- stroke$peak_3sec_50_dyn.x\ndensity_lines(lineData, \"orangered3\")\n\n#lineData <- stroke$peak_4sec_10_dyn.x\n#density_lines(lineData, \"indianred\")\n\nlineData <- stroke$peak_4sec_20_dyn.x\ndensity_lines(lineData, \"firebrick1\")\n\nlineData <- stroke$peak_4sec_30_dyn.x\ndensity_lines(lineData, \"red\")\n\n#lineData <- stroke$peak_4sec_40_dyn.x\n#density_lines(lineData, \"red4\")\n\nlineData <- stroke$peak_4sec_50_dyn.x\ndensity_lines(lineData, \"violetred4\")\n\n\n\nlegend(-32,30,lty=c(1,1),cex=0.8,bty=\"n\",bg=\"n\",\n       c(#\"RM:0.4; G:10\",\n         \"RM:0.4; G:20\",\n         \"RM:0.4; G:30\",\n         #\"RM:0.4; G:40\",\n         \"RM:0.4; G:50*\",\n         #\"RM:1; G:10\",\n         \"RM:1; G:20\",\n         \"RM:1; G:30\",\n         #\"RM:1; G:40\",\n         \"RM:1; G:50*\",\n         #\"RM:2; G:10\",\n         \"RM:2; G:20\",\n         \"RM:2; G:30\",\n         #\"RM:2; G:40\",\n         \"RM:2; G:50*\",\n         #\"RM:3; G:10\",\n         \"RM:3; G:20\",\n         \"RM:3; G:30\",\n         #\"RM:3; G:40\",\n         \"RM:3; G:50*\",\n         #\"RM:4; G:10\",\n         \"RM:4; G:20\",\n         \"RM:4; G:30\",\n         #\"RM:4; G:40\",\n         \"RM:4; G:50*\"),\n       col=c(#\"mediumorchid1\",\n         \"hotpink3\",\n         \"darkorchid1\",\n         #\"darkorchid2\",\n         \"darkmagenta\",\n         #\"darkolivegreen1\",\n         \"chartreuse\",\n         \"chartreuse3\",\n         #\"chartreuse4\",\n         \"darkgreen\",\n         #\"cadetblue1\",\n         \"deepskyblue\",\n         \"blue\",\n         #\"cadetblue4\",\n         \"blue4\",\n         #\"tan\",\n         \"orange\",\n         \"darkorange\",\n         #\"coral\",\n         \"darkorange4\",\n         #\"indianred\",\n         \"firebrick1\",\n         \"red\",\n         #\"red4\",\n         \"violetred4\"))\n\ndev.off()\n",
    "created" : 1481842770946.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1051146154",
    "id" : "E77843D",
    "lastKnownWriteTime" : 1481840243,
    "last_content_update" : 1481840243,
    "path" : "~/Stroke rate methods/R/tape/x_preds_histogram.R",
    "project_path" : "R/tape/x_preds_histogram.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}